package authorization

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestPermissions(T *testing.T) {
	T.Parallel()

	T.Run("household admin", func(t *testing.T) {
		t.Parallel()

		permissionChecker := NewHouseholdRolePermissionChecker(householdAdminRoleName)

		assert.False(t, permissionChecker.HasPermission(CycleCookieSecretPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateUserStatusPermission))
		assert.False(t, permissionChecker.HasPermission(ReadUserPermission))
		assert.False(t, permissionChecker.HasPermission(SearchUserPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateHouseholdPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveHouseholdPermission))
		assert.True(t, permissionChecker.HasPermission(InviteUserToHouseholdPermission))
		assert.True(t, permissionChecker.HasPermission(ModifyMemberPermissionsForHouseholdPermission))
		assert.True(t, permissionChecker.HasPermission(RemoveMemberHouseholdPermission))
		assert.True(t, permissionChecker.HasPermission(TransferHouseholdPermission))
		assert.True(t, permissionChecker.HasPermission(CreateWebhooksPermission))
		assert.True(t, permissionChecker.HasPermission(ReadWebhooksPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateWebhooksPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveWebhooksPermission))
		assert.False(t, permissionChecker.HasPermission(CreateValidInstrumentsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadValidInstrumentsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchValidInstrumentsPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateValidInstrumentsPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveValidInstrumentsPermission))
		assert.False(t, permissionChecker.HasPermission(CreateValidIngredientsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadValidIngredientsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchValidIngredientsPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateValidIngredientsPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveValidIngredientsPermission))
		assert.False(t, permissionChecker.HasPermission(CreateValidPreparationsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadValidPreparationsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchValidPreparationsPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateValidPreparationsPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveValidPreparationsPermission))
		assert.False(t, permissionChecker.HasPermission(CreateValidMeasurementUnitsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadValidMeasurementUnitsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchValidMeasurementUnitsPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateValidMeasurementUnitsPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveValidMeasurementUnitsPermission))
		assert.False(t, permissionChecker.HasPermission(CreateValidIngredientStatesPermission))
		assert.True(t, permissionChecker.HasPermission(ReadValidIngredientStatesPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateValidIngredientStatesPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveValidIngredientStatesPermission))
		assert.False(t, permissionChecker.HasPermission(CreateValidMeasurementUnitConversionsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadValidMeasurementUnitConversionsPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateValidMeasurementUnitConversionsPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveValidMeasurementUnitConversionsPermission))
		assert.False(t, permissionChecker.HasPermission(CreateValidIngredientPreparationsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadValidIngredientPreparationsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchValidIngredientPreparationsPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateValidIngredientPreparationsPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveValidIngredientPreparationsPermission))
		assert.False(t, permissionChecker.HasPermission(CreateValidPreparationInstrumentsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadValidPreparationInstrumentsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchValidPreparationInstrumentsPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateValidPreparationInstrumentsPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveValidPreparationInstrumentsPermission))
		assert.False(t, permissionChecker.HasPermission(CreateValidIngredientMeasurementUnitsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadValidIngredientMeasurementUnitsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchValidIngredientMeasurementUnitsPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateValidIngredientMeasurementUnitsPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveValidIngredientMeasurementUnitsPermission))
		assert.True(t, permissionChecker.HasPermission(CreateMealsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadMealsPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateMealsPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveMealsPermission))
		assert.False(t, permissionChecker.HasPermission(CreateRecipesPermission))
		assert.True(t, permissionChecker.HasPermission(ReadRecipesPermission))
		assert.True(t, permissionChecker.HasPermission(SearchRecipesPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateRecipesPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveRecipesPermission))
		assert.True(t, permissionChecker.HasPermission(CreateRecipePrepTasksPermission))
		assert.True(t, permissionChecker.HasPermission(ReadRecipePrepTasksPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateRecipePrepTasksPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveRecipePrepTasksPermission))
		assert.True(t, permissionChecker.HasPermission(CreateRecipeStepsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadRecipeStepsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchRecipeStepsPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateRecipeStepsPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveRecipeStepsPermission))
		assert.True(t, permissionChecker.HasPermission(CreateRecipeStepInstrumentsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadRecipeStepInstrumentsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchRecipeStepInstrumentsPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateRecipeStepInstrumentsPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveRecipeStepInstrumentsPermission))
		assert.True(t, permissionChecker.HasPermission(CreateRecipeStepIngredientsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadRecipeStepIngredientsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchRecipeStepIngredientsPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateRecipeStepIngredientsPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveRecipeStepIngredientsPermission))
		assert.True(t, permissionChecker.HasPermission(CreateRecipeStepCompletionConditionsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadRecipeStepCompletionConditionsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchRecipeStepCompletionConditionsPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateRecipeStepCompletionConditionsPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveRecipeStepCompletionConditionsPermission))
		assert.True(t, permissionChecker.HasPermission(CreateRecipeStepProductsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadRecipeStepProductsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchRecipeStepProductsPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateRecipeStepProductsPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveRecipeStepProductsPermission))
		assert.True(t, permissionChecker.HasPermission(CreateMealPlansPermission))
		assert.True(t, permissionChecker.HasPermission(ReadMealPlansPermission))
		assert.True(t, permissionChecker.HasPermission(SearchMealPlansPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateMealPlansPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveMealPlansPermission))
		assert.True(t, permissionChecker.HasPermission(CreateMealPlanEventsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadMealPlanEventsPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateMealPlanEventsPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveMealPlanEventsPermission))
		assert.True(t, permissionChecker.HasPermission(CreateMealPlanOptionsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadMealPlanOptionsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchMealPlanOptionsPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateMealPlanOptionsPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveMealPlanOptionsPermission))
		assert.False(t, permissionChecker.HasPermission(CreateMealPlanGroceryListItemsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadMealPlanGroceryListItemsPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateMealPlanGroceryListItemsPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveMealPlanGroceryListItemsPermission))
		assert.True(t, permissionChecker.HasPermission(CreateMealPlanOptionVotesPermission))
		assert.True(t, permissionChecker.HasPermission(ReadMealPlanOptionVotesPermission))
		assert.True(t, permissionChecker.HasPermission(SearchMealPlanOptionVotesPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateMealPlanOptionVotesPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveMealPlanOptionVotesPermission))
		assert.True(t, permissionChecker.HasPermission(ReadMealPlanTasksPermission))
		assert.False(t, permissionChecker.HasPermission(CreateMealPlanTasksPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateMealPlanTasksPermission))
	})

	T.Run("household member", func(t *testing.T) {
		t.Parallel()

		permissionChecker := NewHouseholdRolePermissionChecker(householdMemberRoleName)

		assert.False(t, permissionChecker.HasPermission(CycleCookieSecretPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateUserStatusPermission))
		assert.False(t, permissionChecker.HasPermission(ReadUserPermission))
		assert.False(t, permissionChecker.HasPermission(SearchUserPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateHouseholdPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveHouseholdPermission))
		assert.False(t, permissionChecker.HasPermission(InviteUserToHouseholdPermission))
		assert.False(t, permissionChecker.HasPermission(ModifyMemberPermissionsForHouseholdPermission))
		assert.False(t, permissionChecker.HasPermission(RemoveMemberHouseholdPermission))
		assert.False(t, permissionChecker.HasPermission(TransferHouseholdPermission))
		assert.False(t, permissionChecker.HasPermission(CreateWebhooksPermission))
		assert.True(t, permissionChecker.HasPermission(ReadWebhooksPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateWebhooksPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveWebhooksPermission))
		assert.False(t, permissionChecker.HasPermission(CreateValidInstrumentsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadValidInstrumentsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchValidInstrumentsPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateValidInstrumentsPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveValidInstrumentsPermission))
		assert.False(t, permissionChecker.HasPermission(CreateValidIngredientsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadValidIngredientsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchValidIngredientsPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateValidIngredientsPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveValidIngredientsPermission))
		assert.False(t, permissionChecker.HasPermission(CreateValidPreparationsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadValidPreparationsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchValidPreparationsPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateValidPreparationsPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveValidPreparationsPermission))
		assert.False(t, permissionChecker.HasPermission(CreateValidMeasurementUnitsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadValidMeasurementUnitsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchValidMeasurementUnitsPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateValidMeasurementUnitsPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveValidMeasurementUnitsPermission))
		assert.False(t, permissionChecker.HasPermission(CreateValidIngredientStatesPermission))
		assert.True(t, permissionChecker.HasPermission(ReadValidIngredientStatesPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateValidIngredientStatesPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveValidIngredientStatesPermission))
		assert.False(t, permissionChecker.HasPermission(CreateValidMeasurementUnitConversionsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadValidMeasurementUnitConversionsPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateValidMeasurementUnitConversionsPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveValidMeasurementUnitConversionsPermission))
		assert.False(t, permissionChecker.HasPermission(CreateValidIngredientPreparationsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadValidIngredientPreparationsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchValidIngredientPreparationsPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateValidIngredientPreparationsPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveValidIngredientPreparationsPermission))
		assert.False(t, permissionChecker.HasPermission(CreateValidPreparationInstrumentsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadValidPreparationInstrumentsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchValidPreparationInstrumentsPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateValidPreparationInstrumentsPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveValidPreparationInstrumentsPermission))
		assert.False(t, permissionChecker.HasPermission(CreateValidIngredientMeasurementUnitsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadValidIngredientMeasurementUnitsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchValidIngredientMeasurementUnitsPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateValidIngredientMeasurementUnitsPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveValidIngredientMeasurementUnitsPermission))
		assert.True(t, permissionChecker.HasPermission(CreateMealsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadMealsPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateMealsPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveMealsPermission))
		assert.False(t, permissionChecker.HasPermission(CreateRecipesPermission))
		assert.True(t, permissionChecker.HasPermission(ReadRecipesPermission))
		assert.True(t, permissionChecker.HasPermission(SearchRecipesPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateRecipesPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveRecipesPermission))
		assert.True(t, permissionChecker.HasPermission(CreateRecipePrepTasksPermission))
		assert.True(t, permissionChecker.HasPermission(ReadRecipePrepTasksPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateRecipePrepTasksPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveRecipePrepTasksPermission))
		assert.True(t, permissionChecker.HasPermission(CreateRecipeStepsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadRecipeStepsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchRecipeStepsPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateRecipeStepsPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveRecipeStepsPermission))
		assert.True(t, permissionChecker.HasPermission(CreateRecipeStepInstrumentsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadRecipeStepInstrumentsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchRecipeStepInstrumentsPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateRecipeStepInstrumentsPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveRecipeStepInstrumentsPermission))
		assert.True(t, permissionChecker.HasPermission(CreateRecipeStepIngredientsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadRecipeStepIngredientsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchRecipeStepIngredientsPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateRecipeStepIngredientsPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveRecipeStepIngredientsPermission))
		assert.True(t, permissionChecker.HasPermission(CreateRecipeStepCompletionConditionsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadRecipeStepCompletionConditionsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchRecipeStepCompletionConditionsPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateRecipeStepCompletionConditionsPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveRecipeStepCompletionConditionsPermission))
		assert.True(t, permissionChecker.HasPermission(CreateRecipeStepProductsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadRecipeStepProductsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchRecipeStepProductsPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateRecipeStepProductsPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveRecipeStepProductsPermission))
		assert.False(t, permissionChecker.HasPermission(CreateMealPlansPermission))
		assert.True(t, permissionChecker.HasPermission(ReadMealPlansPermission))
		assert.True(t, permissionChecker.HasPermission(SearchMealPlansPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateMealPlansPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveMealPlansPermission))
		assert.False(t, permissionChecker.HasPermission(CreateMealPlanEventsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadMealPlanEventsPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateMealPlanEventsPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveMealPlanEventsPermission))
		assert.False(t, permissionChecker.HasPermission(CreateMealPlanOptionsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadMealPlanOptionsPermission))
		assert.True(t, permissionChecker.HasPermission(SearchMealPlanOptionsPermission))
		assert.False(t, permissionChecker.HasPermission(UpdateMealPlanOptionsPermission))
		assert.False(t, permissionChecker.HasPermission(ArchiveMealPlanOptionsPermission))
		assert.False(t, permissionChecker.HasPermission(CreateMealPlanGroceryListItemsPermission))
		assert.True(t, permissionChecker.HasPermission(ReadMealPlanGroceryListItemsPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateMealPlanGroceryListItemsPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveMealPlanGroceryListItemsPermission))
		assert.True(t, permissionChecker.HasPermission(CreateMealPlanOptionVotesPermission))
		assert.True(t, permissionChecker.HasPermission(ReadMealPlanOptionVotesPermission))
		assert.True(t, permissionChecker.HasPermission(SearchMealPlanOptionVotesPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateMealPlanOptionVotesPermission))
		assert.True(t, permissionChecker.HasPermission(ArchiveMealPlanOptionVotesPermission))
		assert.True(t, permissionChecker.HasPermission(ReadMealPlanTasksPermission))
		assert.False(t, permissionChecker.HasPermission(CreateMealPlanTasksPermission))
		assert.True(t, permissionChecker.HasPermission(UpdateMealPlanTasksPermission))
	})
}
